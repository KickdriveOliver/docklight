DL_SCRIPTVERSION
1
11577

' XenaxDocklightDemo2_Events.pts
' Precondition: XenaxDocklightDemo.ptp project file is loaded
'               (Menu File --> Open Project...) 
DL.ClearCommWindows
DL.StartCommunication
DL.SendSequence "Events On EVT1"
DL.WaitForSequence "Prompt >"
DL.Pause 500 ' wait for initial events completely received
DL.ResetReceiveCounter
DL.SendSequence "Referencing REF"
DL.WaitForSequence "Event: Referencing Complete"
speed = 20000
acceleration = 400000
Do
    DL.ResetReceiveCounter
    DL.SendSequence "Set Speed SP", speed
    DL.WaitForSequence "Prompt >"
    DL.ResetReceiveCounter
    DL.SendSequence "Set Acceleration AC", acceleration
    DL.WaitForSequence "Prompt >"
    For position = 8000 To 28000 Step 10000
        DL.ResetReceiveCounter
        DL.SendSequence "Go Position G", position
        DL.WaitForSequence "Event: Ready"
        DL.ResetReceiveCounter
        DL.SendSequence "Go Position G", 1000
        DL.WaitForSequence "Event: Ready"
    Next
    speed = speed * 2
    acceleration = acceleration * 2
Loop Until speed > 320000
DL.SendSequence "Power Quit PQ"
DL.Pause 1000
